---
import { ClientRouter } from 'astro:transitions';
import BaseHead from '@components/layout/BaseHead.astro';
import Footer from '@components/layout/Footer.astro';
import Header from '@components/layout/Header.astro';
import SearchModal from '@components/layout/SearchModal.astro';
import '@styles/global.css';
import type { ImageMetadata } from 'astro';

interface Props {
  title: string;
  description?: string;
  image?: string | ImageMetadata;
  type?: 'website' | 'article';
  publishedTime?: Date;
  modifiedTime?: Date;
  tags?: string[];
}

const { title, description, image, type, publishedTime, modifiedTime, tags } = Astro.props;
---

<!doctype html>
<html lang="ja">
  <head>
    <script is:inline>
      (() => {
        let theme = null;
        try {
          theme = localStorage.getItem('theme');
        } catch {
          // localStorage can be unavailable in strict privacy modes.
        }
        const isDark = theme === 'dark' || (!theme && window.matchMedia('(prefers-color-scheme: dark)').matches);
        document.documentElement.classList.toggle('dark', isDark);
      })();
    </script>
    <ClientRouter />
    <BaseHead
      title={title}
      description={description}
      image={image}
      type={type}
      publishedTime={publishedTime}
      modifiedTime={modifiedTime}
      tags={tags}
    />
  </head>
  <body>
    <div class="site-shell">
      <Header />
      <SearchModal />
      <main class="content-container flex-1 pt-24 pb-12 sm:pt-28 sm:pb-20">
        <slot />
      </main>
      <Footer />
    </div>
  </body>
</html>
