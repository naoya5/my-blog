---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import Tag from '@components/ui/Tag.astro';
import { formatDate } from '@utils/formatDate';

interface Props {
  post: CollectionEntry<'blog'>;
}

const { post } = Astro.props;
const heroImage = post.data.heroImage;
---

<article class="card-surface group flex flex-col overflow-hidden">
  <a href={`/blog/${post.slug}/`} class="flex flex-col h-full">
    {heroImage && (
      <div class="relative aspect-video overflow-hidden">
        {typeof heroImage === 'string' ? (
          <img
            src={heroImage}
            alt={post.data.title}
            width="800"
            height="450"
            loading="lazy"
            decoding="async"
            class="h-full w-full object-cover transition-transform duration-700 group-hover:scale-110"
          />
        ) : (
          <Image
            src={heroImage}
            alt={post.data.title}
            width={800}
            height={450}
            class="h-full w-full object-cover transition-transform duration-700 group-hover:scale-110"
          />
        )}
        <div class="absolute inset-0 bg-gradient-to-t from-slate-900/50 to-transparent opacity-0 transition-opacity duration-300 group-hover:opacity-100"></div>
      </div>
    )}
    <div class="flex flex-1 flex-col p-6 sm:p-8">
      <div class="flex items-center gap-3 text-xs font-bold uppercase tracking-widest text-slate-500">
        <time datetime={post.data.pubDate.toISOString()}>
          {formatDate(post.data.pubDate)}
        </time>
        <span class="h-1 w-1 rounded-full bg-slate-300"></span>
        <span class="text-brand-600 dark:text-brand-400">Article</span>
      </div>
      
      <h3 class="mt-4 text-2xl font-black leading-tight tracking-tight transition-colors group-hover:text-brand-600 dark:group-hover:text-brand-400" style="font-family: var(--font-display);">
        {post.data.title}
      </h3>
      
      <p class="mt-4 line-clamp-3 text-sm leading-relaxed text-slate-600 dark:text-slate-400">
        {post.data.description}
      </p>
      
      <div class="mt-auto pt-8 flex flex-wrap gap-2">
        {post.data.tags.slice(0, 3).map((tag) => <Tag name={tag} />)}
      </div>
    </div>
  </a>
</article>
